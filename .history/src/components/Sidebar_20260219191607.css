import React from "react";
import { NavLink, useNavigate } from "react-router-dom";
import "./Sidebar.css";

export default function Sidebar(props) {
  const navigate = useNavigate();

  // Безопасно: если проп не пришёл — не падаем
  const openPanel =
    typeof props.onOpenPanel === "function" ? props.onOpenPanel : null;

  const handleSearch = () => {
    // 1) Если Layout передал функцию — откроем drawer
    if (openPanel) return openPanel("search");
    // 2) Иначе просто перейдем на роут (чтобы не было ошибки)
    navigate("/search");
  };

  const handleNotifications = () => {
    if (openPanel) return openPanel("notifications");
    navigate("/notifications");
  };

  return (
    <aside className="sidebar">
      <div className="sidebar__logo" onClick={() => navigate("/")}>
        <span className="sidebar__logoText">ICHGRAM</span>
      </div>

      <nav className="sidebar__nav">
        <NavLink to="/" className="sidebar__item">
          <span className="sidebar__icon">⌂</span>
          <span className="sidebar__label">Home</span>
        </NavLink>

        <button type="button" className="sidebar__item" onClick={handleSearch}>
          <span className="sidebar__icon">⌕</span>
          <span className="sidebar__label">Search</span>
        </button>

        <NavLink to="/explore" className="sidebar__item">
          <span className="sidebar__icon">◎</span>
          <span className="sidebar__label">Explore</span>
        </NavLink>

        <NavLink to="/messages" className="sidebar__item">
          <span className="sidebar__icon">✉</span>
          <span className="sidebar__label">Messages</span>
        </NavLink>

        <button
          type="button"
          className="sidebar__item"
          onClick={handleNotifications}
        >
          <span className="sidebar__icon">♡</span>
          <span className="sidebar__label">Notifications</span>
        </button>

        <NavLink to="/create" className="sidebar__item">
          <span className="sidebar__icon">＋</span>
          <span className="sidebar__label">Create</span>
        </NavLink>
      </nav>

      <div className="sidebar__bottom">
        <div className="sidebar__divider" />

        <NavLink to="/profile" className="sidebar__profile">
          <div className="sidebar__avatar" />
          <div className="sidebar__profileText">
          .sidebar{
            width:240px;
            height:100vh;
            position:fixed;
            left:0;
            top:0;
            background:#fff;
            border-right:1px solid #dbdbdb;
            padding:14px 12px;
            display:flex;
            flex-direction:column;
          }
          
          .sidebar__logo{
            font-weight:800;
            font-size:20px;
            padding:10px;
            cursor:pointer;
          }
          
          .sidebar__nav{
            display:flex;
            flex-direction:column;
            gap:4px;
            margin-top:10px;
          }
          
          .sidebar__item{
            display:flex;
            align-items:center;
            gap:12px;
            padding:10px;
            border-radius:12px;
            border:0;
            background:transparent;
            cursor:pointer;
            font-size:14px;
          }
          
          .sidebar__item:hover{
            background:#f2f2f2;
          }
          
          .sidebar__icon{
            width:22px;
            text-align:center;
          }
          
          .sidebar__bottom{
            margin-top:auto;
          }
          
          .sidebar__profile{
            display:flex;
            align-items:center;
            gap:10px;
            padding:10px;
            border-radius:12px;
            text-decoration:none;
            color:black;
          }
          
          .sidebar__profile:hover{
            background:#f2f2f2;
          }
          
          .sidebar__avatar{
            width:28px;
            height:28px;
            border-radius:50%;
            background:#ddd;
          }            <div className="sidebar__profileSub">@username</div>
          </div>
        </NavLink>
      </div>
    </aside>
  );
}